(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[429],{7266:function(s,e,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/guides/postgresql",function(){return r(3323)}])},3323:function(s,e,r){"use strict";r.r(e),r.d(e,{__toc:function(){return t}});var n=r(5893),l=r(2673),i=r(6513),o=r(9004);r(4759);var a=r(2643);let t=[{depth:2,value:"Installation",id:"installation"},{depth:2,value:"Basic Setup",id:"basic-setup"},{depth:3,value:"Import and Driver Registration",id:"import-and-driver-registration"},{depth:3,value:"Connection String",id:"connection-string"},{depth:2,value:"Parameter Placeholders",id:"parameter-placeholders"},{depth:2,value:"INSERT with RETURNING",id:"insert-with-returning"},{depth:2,value:"UUID Support",id:"uuid-support"},{depth:3,value:"Auto-Generated UUID",id:"auto-generated-uuid"},{depth:3,value:"Pre-Generated UUID",id:"pre-generated-uuid"},{depth:3,value:"Database Schema for UUID",id:"database-schema-for-uuid"},{depth:2,value:"Parameter Offset Handling in WHERE Clauses",id:"parameter-offset-handling-in-where-clauses"},{depth:2,value:"Dynamic IN Clauses",id:"dynamic-in-clauses"},{depth:3,value:"For Integer IDs",id:"for-integer-ids"},{depth:3,value:"For Parameterized IN Clauses",id:"for-parameterized-in-clauses"},{depth:2,value:"Transaction Patterns",id:"transaction-patterns"},{depth:3,value:"Basic Transaction",id:"basic-transaction"},{depth:3,value:"Transaction with Isolation Level",id:"transaction-with-isolation-level"},{depth:2,value:"Best Practices",id:"best-practices"},{depth:3,value:"1. Use Connection Pooling",id:"1-use-connection-pooling"},{depth:3,value:"2. Always Use Transactions",id:"2-always-use-transactions"},{depth:3,value:"3. Prefer UUID for Distributed Systems",id:"3-prefer-uuid-for-distributed-systems"},{depth:3,value:"4. Use JSONB for Flexible Data",id:"4-use-jsonb-for-flexible-data"},{depth:3,value:"5. Use Prepared Statements for Repeated Queries",id:"5-use-prepared-statements-for-repeated-queries"},{depth:2,value:"PostgreSQL-Specific Features",id:"postgresql-specific-features"},{depth:3,value:"SERIAL vs IDENTITY",id:"serial-vs-identity"},{depth:3,value:"Array Types",id:"array-types"},{depth:3,value:"Full-Text Search",id:"full-text-search"},{depth:2,value:"Common Patterns",id:"common-patterns"},{depth:3,value:"Upsert (INSERT ... ON CONFLICT)",id:"upsert-insert--on-conflict"},{depth:3,value:"Bulk Insert",id:"bulk-insert"},{depth:3,value:"Soft Deletes",id:"soft-deletes"},{depth:2,value:"Troubleshooting",id:"troubleshooting"},{depth:3,value:'"pq: sorry, too many clients already"',id:"pq-sorry-too-many-clients-already"},{depth:3,value:'"pq: SSL is not enabled on the server"',id:"pq-ssl-is-not-enabled-on-the-server"},{depth:3,value:"\"pq: column 'X' does not exist\"",id:"pq-column-x-does-not-exist"},{depth:2,value:"Next Steps",id:"next-steps"}];function c(s){let e=Object.assign({h1:"h1",p:"p",h2:"h2",pre:"pre",code:"code",span:"span",h3:"h3",strong:"strong",ul:"ul",li:"li",ol:"ol",a:"a"},(0,a.a)(),s.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.h1,{children:"PostgreSQL Guide"}),"\n",(0,n.jsx)(e.p,{children:"This guide covers PostgreSQL-specific features and best practices when using go-lightning with PostgreSQL."}),"\n",(0,n.jsx)(e.h2,{id:"installation",children:"Installation"}),"\n",(0,n.jsx)(e.pre,{"data-language":"bash","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(e.code,{"data-language":"bash","data-theme":"default",children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"go"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"get"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"github.com/tracewayapp/go-lightning/lpg"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"go"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"get"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"github.com/jackc/pgx/v5/stdlib"})]})]})}),"\n",(0,n.jsx)(e.h2,{id:"basic-setup",children:"Basic Setup"}),"\n",(0,n.jsx)(e.h3,{id:"import-and-driver-registration",children:"Import and Driver Registration"}),"\n",(0,n.jsx)(e.pre,{"data-language":"go","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(e.code,{"data-language":"go","data-theme":"default",children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"package"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" main"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ("})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"database/sql"'})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    _ "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"github.com/jackc/pgx/v5/stdlib"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// PostgreSQL driver"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"github.com/tracewayapp/go-lightning/lpg"'})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"yourproject/models"'})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:")"})})]})}),"\n",(0,n.jsx)(e.h3,{id:"connection-string",children:"Connection String"}),"\n",(0,n.jsx)(e.pre,{"data-language":"go","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(e.code,{"data-language":"go","data-theme":"default",children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"db, err "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" sql."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"Open"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"pgx"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:", "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"postgres://user:password@localhost:5432/dbname?sslmode=disable"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" err "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"!="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"nil"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    log."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"Fatal"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(err)"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"defer"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" db."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"Close"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"()"})]})]})}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:"Common parameters:"})}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.code,{children:"sslmode=disable"})," - Disable SSL (development only)"]}),"\n",(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.code,{children:"sslmode=require"})," - Require SSL (production)"]}),"\n",(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.code,{children:"pool_max_conns=10"})," - Maximum connections"]}),"\n",(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.code,{children:"pool_min_conns=2"})," - Minimum connections"]}),"\n"]}),"\n",(0,n.jsx)(e.h2,{id:"parameter-placeholders",children:"Parameter Placeholders"}),"\n",(0,n.jsxs)(e.p,{children:["PostgreSQL uses ",(0,n.jsx)(e.strong,{children:"numbered placeholders"}),": ",(0,n.jsx)(e.code,{children:"$1"}),", ",(0,n.jsx)(e.code,{children:"$2"}),", ",(0,n.jsx)(e.code,{children:"$3"}),", etc."]}),"\n",(0,n.jsx)(e.pre,{"data-language":"go","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(e.code,{"data-language":"go","data-theme":"default",children:[(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// Single parameter"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"user, err "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" lpg.SelectGenericSingle[User](tx,"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"SELECT * FROM users WHERE id = $1"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:", userId)"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:" "}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// Multiple parameters"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"users, err "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" lpg.SelectGeneric[User](tx,"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"SELECT * FROM users WHERE age > $1 AND city = $2"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:", "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"25"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:", "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"New York"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:" "}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// IN clause"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"ids "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" []"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"int"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"{"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:", "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"2"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:", "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"3"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"query "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" fmt."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"Sprintf"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"SELECT * FROM users WHERE id IN ('}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"%s"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:')"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    lpg."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"JoinForIn"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(ids))"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"users, err "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" lpg.SelectGeneric[User](tx, query)"})]})]})}),"\n",(0,n.jsx)(e.h2,{id:"insert-with-returning",children:"INSERT with RETURNING"}),"\n",(0,n.jsxs)(e.p,{children:["PostgreSQL's ",(0,n.jsx)(e.code,{children:"lpg.InsertGeneric"})," uses the ",(0,n.jsx)(e.code,{children:"RETURNING id"})," clause to retrieve auto-generated IDs:"]}),"\n",(0,n.jsx)(e.pre,{"data-language":"go","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(e.code,{"data-language":"go","data-theme":"default",children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"user "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"&"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"User{"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    FirstName: "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"John"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    LastName:  "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Doe"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    Email:     "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"john@example.com"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,n.jsx)(e.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"id, err "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" lpg."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"InsertGeneric"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(tx, user)"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" err "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"!="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"nil"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    log."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"Fatal"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(err)"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"fmt."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"Printf"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Inserted user with ID: '}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"%d"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'\\n"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:", id)"})]})]})}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:"Generated SQL:"})}),"\n",(0,n.jsx)(e.pre,{"data-language":"sql","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(e.code,{"data-language":"sql","data-theme":"default",children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"INSERT INTO"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" users (first_name, last_name, email)"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"VALUES"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ($"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:", $"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"2"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:", $"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"3"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"RETURNING id"})})]})}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:"Why this matters:"})}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsxs)(e.li,{children:["PostgreSQL doesn't support ",(0,n.jsx)(e.code,{children:"LastInsertId()"})," like MySQL"]}),"\n",(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.code,{children:"RETURNING id"})," retrieves the generated ID in a single roundtrip"]}),"\n",(0,n.jsx)(e.li,{children:"More efficient than a separate SELECT query"}),"\n"]}),"\n",(0,n.jsx)(e.h2,{id:"uuid-support",children:"UUID Support"}),"\n",(0,n.jsx)(e.p,{children:"PostgreSQL excels at UUID primary keys. go-lightning provides built-in UUID support:"}),"\n",(0,n.jsx)(e.h3,{id:"auto-generated-uuid",children:"Auto-Generated UUID"}),"\n",(0,n.jsx)(e.pre,{"data-language":"go","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(e.code,{"data-language":"go","data-theme":"default",children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"type"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"Entity"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"struct"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    Id          "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"string"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// UUID will be auto-generated"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    Name        "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"string"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    Description "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"string"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,n.jsx)(e.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"func"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"init"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"() {"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    lpg.Register[Entity]()"})}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,n.jsx)(e.span,{className:"line",children:" "}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// Usage"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"entity "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"&"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Entity{"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    Name:        "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"My Entity"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    Description: "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Description here"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,n.jsx)(e.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"uuid, err "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" lpg."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"InsertGenericUuid"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(tx, entity)"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" err "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"!="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"nil"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    log."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"Fatal"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(err)"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,n.jsx)(e.span,{className:"line",children:" "}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// entity.Id is now set to the generated UUID"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"fmt."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"Printf"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Generated UUID: '}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"%s"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'\\n"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:", uuid)"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"fmt."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"Printf"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Entity ID: '}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"%s"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'\\n"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:", entity.Id)"})]})]})}),"\n",(0,n.jsx)(e.h3,{id:"pre-generated-uuid",children:"Pre-Generated UUID"}),"\n",(0,n.jsx)(e.p,{children:"If you generate the UUID yourself:"}),"\n",(0,n.jsx)(e.pre,{"data-language":"go","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(e.code,{"data-language":"go","data-theme":"default",children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"github.com/google/uuid"'})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"entity "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"&"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Entity{"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    Id:          uuid."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"New"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"()."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"String"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(),"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    Name:        "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"My Entity"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    Description: "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Description here"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,n.jsx)(e.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"err "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" lpg."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"InsertGenericExistingUuid"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(tx, entity)"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" err "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"!="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"nil"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    log."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"Fatal"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(err)"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,n.jsx)(e.h3,{id:"database-schema-for-uuid",children:"Database Schema for UUID"}),"\n",(0,n.jsx)(e.pre,{"data-language":"sql","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(e.code,{"data-language":"sql","data-theme":"default",children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"CREATE"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"TABLE"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"entities"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ("})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    id UUID "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"PRIMARY KEY"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"DEFAULT"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" gen_random_uuid(),"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"name"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"TEXT"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"NOT NULL"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"description"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"TEXT"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:");"})})]})}),"\n",(0,n.jsx)(e.p,{children:"Or use extension for older PostgreSQL versions:"}),"\n",(0,n.jsx)(e.pre,{"data-language":"sql","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(e.code,{"data-language":"sql","data-theme":"default",children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"CREATE"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" EXTENSION "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"IF"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"NOT"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"EXISTS"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"uuid-ossp"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"CREATE"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"TABLE"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"entities"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ("})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    id UUID "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"PRIMARY KEY"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"DEFAULT"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" uuid_generate_v4(),"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"name"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"TEXT"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"NOT NULL"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"description"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"TEXT"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:");"})})]})}),"\n",(0,n.jsx)(e.h2,{id:"parameter-offset-handling-in-where-clauses",children:"Parameter Offset Handling in WHERE Clauses"}),"\n",(0,n.jsxs)(e.p,{children:["go-lightning automatically renumbers ",(0,n.jsx)(e.code,{children:"$N"})," placeholders in WHERE clauses for ",(0,n.jsx)(e.code,{children:"UpdateGeneric"}),":"]}),"\n",(0,n.jsx)(e.pre,{"data-language":"go","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(e.code,{"data-language":"go","data-theme":"default",children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"user "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"&"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"User{"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    Id:        "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    FirstName: "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Jane"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    LastName:  "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Doe"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    Email:     "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"jane@example.com"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,n.jsx)(e.span,{className:"line",children:" "}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// UpdateGeneric automatically adjusts parameter numbers"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"err "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" lpg."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"UpdateGeneric"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(tx, user, "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"id = $1"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:", user.Id)"})]})]})}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:"What happens internally:"})}),"\n",(0,n.jsxs)(e.ol,{children:["\n",(0,n.jsxs)(e.li,{children:["UPDATE query uses ",(0,n.jsx)(e.code,{children:"$1, $2, $3"})," for struct fields"]}),"\n",(0,n.jsxs)(e.li,{children:["WHERE clause parameter ",(0,n.jsx)(e.code,{children:"$1"})," is ",(0,n.jsx)(e.strong,{children:"renumbered"})," to ",(0,n.jsx)(e.code,{children:"$4"})]}),"\n",(0,n.jsxs)(e.li,{children:["Final query: ",(0,n.jsx)(e.code,{children:"UPDATE users SET first_name = $1, last_name = $2, email = $3 WHERE id = $4"})]}),"\n"]}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:"This allows intuitive WHERE clauses:"})}),"\n",(0,n.jsx)(e.pre,{"data-language":"go","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(e.code,{"data-language":"go","data-theme":"default",children:[(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// Simple WHERE"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"lpg."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"UpdateGeneric"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(tx, user, "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"id = $1"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:", user.Id)"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:" "}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// Complex WHERE"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"lpg."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"UpdateGeneric"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(tx, user, "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"id = $1 AND organization_id = $2"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:", userId, orgId)"})]})]})}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:"Without automatic renumbering, you'd need:"})}),"\n",(0,n.jsx)(e.pre,{"data-language":"go","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(e.code,{"data-language":"go","data-theme":"default",children:[(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// This would be error-prone"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"lpg."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"UpdateGeneric"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(tx, user, "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"id = $4 AND organization_id = $5"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:", userId, orgId)"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"//                                     ^^               ^^  <- Hard to track!"})})]})}),"\n",(0,n.jsx)(e.h2,{id:"dynamic-in-clauses",children:"Dynamic IN Clauses"}),"\n",(0,n.jsx)(e.h3,{id:"for-integer-ids",children:"For Integer IDs"}),"\n",(0,n.jsxs)(e.p,{children:["Use ",(0,n.jsx)(e.code,{children:"JoinForIn"})," to build comma-separated lists:"]}),"\n",(0,n.jsx)(e.pre,{"data-language":"go","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(e.code,{"data-language":"go","data-theme":"default",children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"ids "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" []"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"int"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"{"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:", "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"2"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:", "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"3"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:", "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"4"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:", "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"5"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"query "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" fmt."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"Sprintf"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"SELECT * FROM users WHERE id IN ('}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"%s"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:')"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:", lpg."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"JoinForIn"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(ids))"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"users, err "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" lpg.SelectGeneric[User](tx, query)"})]})]})}),"\n",(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:"Output:"})," ",(0,n.jsx)(e.code,{children:"SELECT * FROM users WHERE id IN (1,2,3,4,5)"})]}),"\n",(0,n.jsx)(e.h3,{id:"for-parameterized-in-clauses",children:"For Parameterized IN Clauses"}),"\n",(0,n.jsxs)(e.p,{children:["Use ",(0,n.jsx)(e.code,{children:"JoinStringForIn"})," with parameter offset:"]}),"\n",(0,n.jsx)(e.pre,{"data-language":"go","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(e.code,{"data-language":"go","data-theme":"default",children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"usernames "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" []"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"string"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"{"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"alice"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:", "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"bob"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:", "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"charlie"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"query "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" fmt."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"Sprintf"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"SELECT * FROM users WHERE username IN ('}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"%s"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:')"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    lpg."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"JoinStringForIn"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:", usernames))"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"users, err "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" lpg.SelectGeneric[User](tx, query, usernames"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"..."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:")"})]})]})}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:"Output:"})}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsxs)(e.li,{children:["Query: ",(0,n.jsx)(e.code,{children:"SELECT * FROM users WHERE username IN ($1,$2,$3)"})]}),"\n",(0,n.jsxs)(e.li,{children:["Args: ",(0,n.jsx)(e.code,{children:'["alice", "bob", "charlie"]'})]}),"\n"]}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:"With offset (e.g., after other parameters):"})}),"\n",(0,n.jsx)(e.pre,{"data-language":"go","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(e.code,{"data-language":"go","data-theme":"default",children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"age "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"25"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"usernames "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" []"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"string"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"{"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"alice"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:", "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"bob"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"query "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" fmt."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"Sprintf"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"SELECT * FROM users WHERE age > $1 AND username IN ('}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"%s"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:')"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    lpg."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"JoinStringForIn"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:", usernames))  "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// offset=1 because $1 is used for age"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"users, err "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" lpg.SelectGeneric[User](tx, query, age, usernames"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"..."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:")"})]})]})}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:"Output:"})}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsxs)(e.li,{children:["Query: ",(0,n.jsx)(e.code,{children:"SELECT * FROM users WHERE age > $1 AND username IN ($2,$3)"})]}),"\n",(0,n.jsxs)(e.li,{children:["Args: ",(0,n.jsx)(e.code,{children:'[25, "alice", "bob"]'})]}),"\n"]}),"\n",(0,n.jsx)(e.h2,{id:"transaction-patterns",children:"Transaction Patterns"}),"\n",(0,n.jsx)(e.h3,{id:"basic-transaction",children:"Basic Transaction"}),"\n",(0,n.jsx)(e.pre,{"data-language":"go","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(e.code,{"data-language":"go","data-theme":"default",children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"tx, err "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" db."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"Begin"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"()"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" err "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"!="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"nil"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" err"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"defer"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"Rollback"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"()  "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// Safe even after Commit()"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:" "}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// Operations"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"id, err "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" lpg."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"InsertGeneric"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(tx, "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"&"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"user)"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" err "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"!="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"nil"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" err  "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// Rollback via defer"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,n.jsx)(e.span,{className:"line",children:" "}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// Commit"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" err "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"Commit"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(); err "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"!="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"nil"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" err"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,n.jsx)(e.h3,{id:"transaction-with-isolation-level",children:"Transaction with Isolation Level"}),"\n",(0,n.jsx)(e.pre,{"data-language":"go","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(e.code,{"data-language":"go","data-theme":"default",children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"tx, err "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" db."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"BeginTx"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(context."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"Background"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(), "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"&"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"sql.TxOptions{"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    Isolation: sql.LevelSerializable,"})}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"})"})})]})}),"\n",(0,n.jsx)(e.p,{children:"Available levels:"}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.code,{children:"sql.LevelDefault"})," - Database default"]}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"sql.LevelReadUncommitted"})}),"\n",(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.code,{children:"sql.LevelReadCommitted"})," - PostgreSQL default"]}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"sql.LevelRepeatableRead"})}),"\n",(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.code,{children:"sql.LevelSerializable"})," - Strongest isolation"]}),"\n"]}),"\n",(0,n.jsx)(e.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,n.jsx)(e.h3,{id:"1-use-connection-pooling",children:"1. Use Connection Pooling"}),"\n",(0,n.jsx)(e.pre,{"data-language":"go","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(e.code,{"data-language":"go","data-theme":"default",children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"db."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"SetMaxOpenConns"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"25"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"db."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"SetMaxIdleConns"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"5"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"db."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"SetConnMaxLifetime"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"5"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"*"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" time.Minute)"})]})]})}),"\n",(0,n.jsx)(e.h3,{id:"2-always-use-transactions",children:"2. Always Use Transactions"}),"\n",(0,n.jsx)(e.p,{children:"Even for single operations, transactions provide:"}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsx)(e.li,{children:"Consistency guarantees"}),"\n",(0,n.jsx)(e.li,{children:"Explicit commit/rollback control"}),"\n",(0,n.jsx)(e.li,{children:"Better error handling"}),"\n"]}),"\n",(0,n.jsx)(e.h3,{id:"3-prefer-uuid-for-distributed-systems",children:"3. Prefer UUID for Distributed Systems"}),"\n",(0,n.jsx)(e.pre,{"data-language":"go","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(e.code,{"data-language":"go","data-theme":"default",children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"type"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"User"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"struct"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    Id    "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"string"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// UUID"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    Name  "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"string"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    Email "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"string"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:"Advantages:"})}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsx)(e.li,{children:"No coordination needed across databases"}),"\n",(0,n.jsx)(e.li,{children:"Merge-friendly (no ID conflicts)"}),"\n",(0,n.jsx)(e.li,{children:"Can generate client-side"}),"\n"]}),"\n",(0,n.jsx)(e.h3,{id:"4-use-jsonb-for-flexible-data",children:"4. Use JSONB for Flexible Data"}),"\n",(0,n.jsx)(e.p,{children:"PostgreSQL's JSONB type works well with go-lightning:"}),"\n",(0,n.jsx)(e.pre,{"data-language":"go","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(e.code,{"data-language":"go","data-theme":"default",children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"type"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"Product"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"struct"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    Id         "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"int"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    Name       "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"string"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    Attributes "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"string"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// JSON string"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,n.jsx)(e.span,{className:"line",children:" "}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// In your application"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"encoding/json"'})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"attrs "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"map"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"["}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"string"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"]"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"interface"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"{}{"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"color"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:": "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"red"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"size"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:":  "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"large"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"attrsJSON, _ "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" json."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"Marshal"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(attrs)"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"product "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"&"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Product{"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    Name:       "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"T-Shirt"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    Attributes: "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"string"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(attrsJSON),"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:"Schema:"})}),"\n",(0,n.jsx)(e.pre,{"data-language":"sql","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(e.code,{"data-language":"sql","data-theme":"default",children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"CREATE"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"TABLE"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"products"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ("})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    id "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"SERIAL"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"PRIMARY KEY"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"name"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"TEXT"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"NOT NULL"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    attributes JSONB"})}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:");"})})]})}),"\n",(0,n.jsx)(e.h3,{id:"5-use-prepared-statements-for-repeated-queries",children:"5. Use Prepared Statements for Repeated Queries"}),"\n",(0,n.jsxs)(e.p,{children:["While go-lightning doesn't expose prepared statements directly, the underlying ",(0,n.jsx)(e.code,{children:"database/sql"})," driver handles this:"]}),"\n",(0,n.jsx)(e.pre,{"data-language":"go","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(e.code,{"data-language":"go","data-theme":"default",children:[(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// The driver automatically prepares this query"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"for"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" _, email "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"range"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" emails {"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    user, _ "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" lpg.SelectGenericSingle[User](tx,"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"SELECT * FROM users WHERE email = $1"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:", email)"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,n.jsx)(e.h2,{id:"postgresql-specific-features",children:"PostgreSQL-Specific Features"}),"\n",(0,n.jsx)(e.h3,{id:"serial-vs-identity",children:"SERIAL vs IDENTITY"}),"\n",(0,n.jsxs)(e.p,{children:["Modern PostgreSQL (10+) prefers ",(0,n.jsx)(e.code,{children:"IDENTITY"}),":"]}),"\n",(0,n.jsx)(e.pre,{"data-language":"sql","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(e.code,{"data-language":"sql","data-theme":"default",children:[(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"-- Old way (SERIAL)"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"CREATE"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"TABLE"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"users"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ("})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    id "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"SERIAL"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"PRIMARY KEY"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"name"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"TEXT"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:");"})}),"\n",(0,n.jsx)(e.span,{className:"line",children:" "}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"-- New way (IDENTITY) - Recommended"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"CREATE"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"TABLE"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"users"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ("})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    id "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"INT"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"GENERATED"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"ALWAYS"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"IDENTITY"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"PRIMARY KEY"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"name"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"TEXT"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:");"})})]})}),"\n",(0,n.jsx)(e.p,{children:"Both work with go-lightning's auto-increment detection."}),"\n",(0,n.jsx)(e.h3,{id:"array-types",children:"Array Types"}),"\n",(0,n.jsxs)(e.p,{children:["PostgreSQL arrays can be used with custom ",(0,n.jsx)(e.code,{children:"mapLine"})," functions:"]}),"\n",(0,n.jsx)(e.pre,{"data-language":"go","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(e.code,{"data-language":"go","data-theme":"default",children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"type"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"User"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"struct"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    Id    "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"int"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    Name  "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"string"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    Tags  []"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"string"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// PostgreSQL array"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,n.jsx)(e.span,{className:"line",children:" "}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// Use manual operations for arrays"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"func"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"mapUser"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(rows "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"*"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"sql.Rows, user "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"*"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"User) "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"error"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" rows."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"Scan"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"&"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"user.Id, "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"&"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"user.Name, pq."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"Array"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"&"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"user.Tags))"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,n.jsx)(e.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"users, err "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" lpg.SelectMultiple[User](tx, mapUser,"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"SELECT id, name, tags FROM users"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:")"})]})]})}),"\n",(0,n.jsx)(e.h3,{id:"full-text-search",children:"Full-Text Search"}),"\n",(0,n.jsx)(e.pre,{"data-language":"go","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(e.code,{"data-language":"go","data-theme":"default",children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"query "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"`"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"    SELECT * FROM articles"})}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"    WHERE to_tsvector('english', title || ' ' || content) @@ plainto_tsquery($1)"})}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"`"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"articles, err "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" lpg.SelectGeneric[Article](tx, query, "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"golang database"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:")"})]})]})}),"\n",(0,n.jsx)(e.h2,{id:"common-patterns",children:"Common Patterns"}),"\n",(0,n.jsx)(e.h3,{id:"upsert-insert--on-conflict",children:"Upsert (INSERT ... ON CONFLICT)"}),"\n",(0,n.jsx)(e.pre,{"data-language":"go","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(e.code,{"data-language":"go","data-theme":"default",children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"query "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"`"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"    INSERT INTO users (id, name, email)"})}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"    VALUES ($1, $2, $3)"})}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"    ON CONFLICT (email)"})}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"    DO UPDATE SET name = EXCLUDED.name"})}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"    RETURNING id"})}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"`"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"id, err "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" lpg."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"Insert"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(tx, query, user.Id, user.Name, user.Email)"})]})]})}),"\n",(0,n.jsx)(e.h3,{id:"bulk-insert",children:"Bulk Insert"}),"\n",(0,n.jsx)(e.pre,{"data-language":"go","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(e.code,{"data-language":"go","data-theme":"default",children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"query "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"`"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"    INSERT INTO users (first_name, last_name, email)"})}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"    VALUES ($1, $2, $3), ($4, $5, $6), ($7, $8, $9)"})}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"    RETURNING id"})}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"`"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"rows, err "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"Query"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(query,"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"John"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:", "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Doe"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:", "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"john@example.com"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Jane"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:", "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Doe"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:", "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"jane@example.com"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Bob"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:", "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Smith"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:", "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"bob@example.com"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:")"})}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// Scan IDs..."})})]})}),"\n",(0,n.jsx)(e.h3,{id:"soft-deletes",children:"Soft Deletes"}),"\n",(0,n.jsx)(e.pre,{"data-language":"go","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(e.code,{"data-language":"go","data-theme":"default",children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"type"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"User"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"struct"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    Id        "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"int"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    Name      "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"string"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    DeletedAt "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"*"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"time.Time  "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// NULL when not deleted"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,n.jsx)(e.span,{className:"line",children:" "}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// Soft delete"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"err "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" lpg."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"Update"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(tx, "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"UPDATE users SET deleted_at = NOW() WHERE id = $1"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:", userId)"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:" "}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// Query only active users"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"users, err "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" lpg.SelectGeneric[User](tx,"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"SELECT * FROM users WHERE deleted_at IS NULL"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:")"})]})]})}),"\n",(0,n.jsx)(e.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,n.jsx)(e.h3,{id:"pq-sorry-too-many-clients-already",children:'"pq: sorry, too many clients already"'}),"\n",(0,n.jsx)(e.p,{children:"Reduce connection pool size:"}),"\n",(0,n.jsx)(e.pre,{"data-language":"go","data-theme":"default",hasCopyCode:!0,children:(0,n.jsx)(e.code,{"data-language":"go","data-theme":"default",children:(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"db."}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"SetMaxOpenConns"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"10"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:")"})]})})}),"\n",(0,n.jsx)(e.h3,{id:"pq-ssl-is-not-enabled-on-the-server",children:'"pq: SSL is not enabled on the server"'}),"\n",(0,n.jsx)(e.p,{children:"Either enable SSL on server or disable in connection string:"}),"\n",(0,n.jsx)(e.pre,{"data-language":"go","data-theme":"default",hasCopyCode:!0,children:(0,n.jsx)(e.code,{"data-language":"go","data-theme":"default",children:(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"postgres://user:pass@host/db?sslmode=disable"'})})})}),"\n",(0,n.jsx)(e.h3,{id:"pq-column-x-does-not-exist",children:"\"pq: column 'X' does not exist\""}),"\n",(0,n.jsx)(e.p,{children:"Check naming strategy mapping:"}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsxs)(e.li,{children:["Go: ",(0,n.jsx)(e.code,{children:"CreatedAt"}),"  Database: ",(0,n.jsx)(e.code,{children:"created_at"})]}),"\n",(0,n.jsx)(e.li,{children:"Ensure struct fields match database columns"}),"\n"]}),"\n",(0,n.jsx)(e.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.a,{href:"/guides/transactions",children:"Transactions Guide"})," - Advanced transaction patterns"]}),"\n",(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.a,{href:"/examples/uuid-entities",children:"UUID Entities Example"})," - Complete UUID example"]}),"\n",(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.a,{href:"/api-reference/postgresql/crud-operations",children:"PostgreSQL API Reference"})," - Full API documentation"]}),"\n"]})]})}let h={MDXContent:function(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:e}=Object.assign({},(0,a.a)(),s.components);return e?(0,n.jsx)(e,{...s,children:(0,n.jsx)(c,{...s})}):c(s)},pageOpts:{filePath:"pages/guides/postgresql.mdx",route:"/guides/postgresql",timestamp:1766515491e3,pageMap:[{kind:"Meta",data:{index:"Home","getting-started":"Getting Started",guides:"Guides","api-reference":"API Reference",examples:"Examples",troubleshooting:"Troubleshooting",contributing:"Contributing"}},{kind:"Folder",name:"api-reference",route:"/api-reference",children:[{kind:"Meta",data:{core:"Core",postgresql:"PostgreSQL",mysql:"MySQL"}},{kind:"Folder",name:"core",route:"/api-reference/core",children:[{kind:"Meta",data:{interfaces:"Interfaces",registration:"Registration","generic-operations":"Generic Operations","manual-operations":"Manual Operations",helpers:"Helper Functions"}},{kind:"MdxPage",name:"generic-operations",route:"/api-reference/core/generic-operations"},{kind:"MdxPage",name:"helpers",route:"/api-reference/core/helpers"},{kind:"MdxPage",name:"interfaces",route:"/api-reference/core/interfaces"},{kind:"MdxPage",name:"manual-operations",route:"/api-reference/core/manual-operations"},{kind:"MdxPage",name:"registration",route:"/api-reference/core/registration"}]},{kind:"Folder",name:"mysql",route:"/api-reference/mysql",children:[{kind:"Meta",data:{overview:"Overview","crud-operations":"CRUD Operations"}},{kind:"MdxPage",name:"crud-operations",route:"/api-reference/mysql/crud-operations"},{kind:"MdxPage",name:"overview",route:"/api-reference/mysql/overview"}]},{kind:"Folder",name:"postgresql",route:"/api-reference/postgresql",children:[{kind:"Meta",data:{overview:"Overview","crud-operations":"CRUD Operations","uuid-support":"UUID Support","parameter-handling":"Parameter Handling"}},{kind:"MdxPage",name:"crud-operations",route:"/api-reference/postgresql/crud-operations"},{kind:"MdxPage",name:"overview",route:"/api-reference/postgresql/overview"},{kind:"MdxPage",name:"parameter-handling",route:"/api-reference/postgresql/parameter-handling"},{kind:"MdxPage",name:"uuid-support",route:"/api-reference/postgresql/uuid-support"}]}]},{kind:"Folder",name:"contributing",route:"/contributing",children:[{kind:"Meta",data:{development:"Development Setup",testing:"Testing"}},{kind:"MdxPage",name:"development",route:"/contributing/development"},{kind:"MdxPage",name:"testing",route:"/contributing/testing"}]},{kind:"Folder",name:"examples",route:"/examples",children:[{kind:"Meta",data:{"basic-crud":"Basic CRUD","postgresql-complete":"PostgreSQL Complete Example","mysql-complete":"MySQL Complete Example","uuid-entities":"UUID Entities","custom-naming":"Custom Naming Strategy","advanced-queries":"Advanced Queries"}},{kind:"MdxPage",name:"advanced-queries",route:"/examples/advanced-queries"},{kind:"MdxPage",name:"basic-crud",route:"/examples/basic-crud"},{kind:"MdxPage",name:"custom-naming",route:"/examples/custom-naming"},{kind:"MdxPage",name:"mysql-complete",route:"/examples/mysql-complete"},{kind:"MdxPage",name:"postgresql-complete",route:"/examples/postgresql-complete"},{kind:"MdxPage",name:"uuid-entities",route:"/examples/uuid-entities"}]},{kind:"Folder",name:"getting-started",route:"/getting-started",children:[{kind:"Meta",data:{introduction:"Introduction",installation:"Installation","quick-start":"Quick Start","core-concepts":"Core Concepts"}},{kind:"MdxPage",name:"core-concepts",route:"/getting-started/core-concepts"},{kind:"MdxPage",name:"installation",route:"/getting-started/installation"},{kind:"MdxPage",name:"introduction",route:"/getting-started/introduction"},{kind:"MdxPage",name:"quick-start",route:"/getting-started/quick-start"}]},{kind:"Folder",name:"guides",route:"/guides",children:[{kind:"Meta",data:{postgresql:"PostgreSQL",mysql:"MySQL",registration:"Registration System","naming-strategies":"Naming Strategies",transactions:"Transactions"}},{kind:"MdxPage",name:"mysql",route:"/guides/mysql"},{kind:"MdxPage",name:"naming-strategies",route:"/guides/naming-strategies"},{kind:"MdxPage",name:"postgresql",route:"/guides/postgresql"},{kind:"MdxPage",name:"registration",route:"/guides/registration"},{kind:"MdxPage",name:"transactions",route:"/guides/transactions"}]},{kind:"MdxPage",name:"index",route:"/"},{kind:"Folder",name:"troubleshooting",route:"/troubleshooting",children:[{kind:"Meta",data:{"common-errors":"Common Errors",debugging:"Debugging Guide","migration-guide":"Migration Guide"}},{kind:"MdxPage",name:"common-errors",route:"/troubleshooting/common-errors"},{kind:"MdxPage",name:"debugging",route:"/troubleshooting/debugging"},{kind:"MdxPage",name:"migration-guide",route:"/troubleshooting/migration-guide"}]}],flexsearch:{codeblocks:!0},title:"PostgreSQL Guide",headings:t},pageNextRoute:"/guides/postgresql",nextraLayout:i.ZP,themeConfig:o.Z};e.default=(0,l.j)(h)},9004:function(s,e,r){"use strict";var n=r(5893);e.Z={logo:(0,n.jsx)("span",{style:{fontWeight:700,fontSize:"1.2rem"},children:" go-lightning"}),project:{link:"https://github.com/tracewayapp/go-lightning"},docsRepositoryBase:"https://github.com/tracewayapp/go-lightning/tree/main/docs",useNextSeoProps:()=>({titleTemplate:"%s  go-lightning"}),head:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0"}),(0,n.jsx)("meta",{property:"og:title",content:"go-lightning"}),(0,n.jsx)("meta",{property:"og:description",content:"Lightweight Go library for simplified database operations"})]}),primaryHue:205,darkMode:!0,nextThemes:{defaultTheme:"dark"},sidebar:{defaultMenuCollapseLevel:1,toggleButton:!0},toc:{backToTop:!0},editLink:{text:"Edit this page on GitHub "},feedback:{content:"Question? Give us feedback ",labels:"feedback"},footer:{text:(0,n.jsxs)("span",{children:["MIT ",new Date().getFullYear()," \xa9"," ",(0,n.jsx)("a",{href:"https://github.com/tracewayapp",target:"_blank",children:"Traceway"})]})}}},5789:function(){}},function(s){s.O(0,[73,888,774,179],function(){return s(s.s=7266)}),_N_E=s.O()}]);